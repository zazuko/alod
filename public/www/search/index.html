<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="//cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" integrity="sha256-LxKiHTQko0DUCUSgrIK23SYMymvfuj8uxXmblBvVWm0=" crossorigin="anonymous">
  <link href="//cdn.jsdelivr.net/npm/bootstrap-tour@0.12.0/build/css/bootstrap-tour.min.css" rel="stylesheet" crossorigin="anonymous">
  <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">

  <link href="zack.css" rel="stylesheet">
</head>
<body>
<div class="container">
  <nav class="navbar navbar-default">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#"><div id="zack-spinner" class="spinner paused"></div></a>
        <a class="navbar-brand hidden-xs hidden-sm" href="#">aLOD.ch - Archival Linked Open Data</a>
        <a class="navbar-brand visible-xs visible-sm" href="#">aLOD.ch</a>
      </div>
      <div id="navbar" class="navbar-collapse collapse">
        <ul class="nav navbar-nav navbar-right">
          <li><a id="zack-intro" href="#"><i class="fa fa-question"></i></a></li>
          <li class="active"><a href="#">Search</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Participating Archives <span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a target="_blank" href="http://www.bar.admin.ch/">Archives fédérales suisses</a></li>
              <li><a target="_blank" href="http://www.ne.ch/archives">Archives de l’Etat de Neuchâtel</a></li>
              <li><a target="_blank" href="http://www.vs.ch/Navig/navig.asp?MenuID=20179">Archives de l’Etat du Valais</a></li>
              <li><a target="_blank" href="http://etat.geneve.ch/dt/archives/">Archives d’Etat de Genève</a></li>
              <li><a target="_blank" href="http://www.staatsarchiv.bs.ch/">Archives cantonales de Bâle-Ville</a></li>
              <li><a target="_blank" href="#">Archives de la Ville de Baden</a></li>
            </ul>
          </li>
          <li><a href="/">About</a></li>
        </ul>
      </div><!--/.nav-collapse -->
    </div><!--/.container-fluid -->
  </nav>
  <div class="bs-docs-section">
    <div class="row">
       <div class="zack-query-box">
         <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
           <div class="form-group has-feedback has-clear zack-query-group">
             <input autofocus id="query" class="form-control input-lg zack-query-input" type="text" placeholder="Refine Result with Keywords.">
             <a id="clear" class="glyphicon glyphicon-remove-sign form-control-feedback form-control-clear" style="visibility: hidden; pointer-events: auto; text-decoration: none; cursor: pointer;"></a>
           </div>
         </div>
         <div id="type-filters" class="col-lg-8 col-md-8 hidden-sm hidden-xs">
         </div>
       </div>
    </div>
    <div class="row">
      <div class="col-lg-12">
        <div id="filter-container" class="zack-filter">&nbsp;
        </div>
      </div>
    </div>
    <div class="zack-content">
      <div class="zack-result-list">
        <div id="timeCursor" class="result-time-cursor"></div>
        <div id="scrollArea" class="clusterize-scroll">
          <div id="contentArea" class="clusterize-content">
            <div class="clusterize-no-data">Loading data…</div>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="zack-overview">
        <div id="zack-timeline" class="col-lg-10 col-md-10 col-sm-10 col-xs-10">
        </div>
        <div class="col-lg-2 hidden-xs">
          <div class="zack-meta pull-right">
            <span id="count" class="zack-count zack-big"></span> <i>Results</i>
          </div>
        </div>
        <div class="col-lg-2">
          <button class="zack-reset pull-right">
            Reset
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>
<script src="//cdn.jsdelivr.net/npm/bootstrap-tour@0.12.0/build/js/bootstrap-tour.min.js" crossorigin="anonymous"></script>
<script src="//cdn.jsdelivr.net/npm/color-hash@1.0.3/dist/color-hash.js" crossorigin="anonymous"></script><!-- required by renderer -->

<script id="custom-stardog-fulltext-part.sparql" type="application/sparql-query">
?sub skos:hiddenLabel ?l .
(?l ?score) <tag:stardog:api:property:textMatch> "${searchString}" .
</script>
<script id="custom-stardog-resultset.sparql" type="application/sparql-query">
PREFIX : <http://voc.zazuko.com/zack#>
PREFIX  rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX  text: <http://jena.apache.org/text#>
PREFIX  rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX  skos: <http://www.w3.org/2004/02/skos/core#>
PREFIX  xsd: <http://www.w3.org/2001/XMLSchema#>

CONSTRUCT {
  :query :result ?sub .
  ?sub a :resultItem .
  ?sub ?pred ?obj .
  ?sub1 <http://data.archiveshub.ac.uk/def/level> ?level1 .
  ?sub1 <http://purl.org/dc/terms/title> ?title1 .
  ?sub1 <http://purl.org/dc/terms/relation> ?sub2 .

  ?sub2 <http://data.archiveshub.ac.uk/def/level> ?level2 .
  ?sub2 <http://purl.org/dc/terms/title> ?title2 .
  ?sub2 <http://purl.org/dc/terms/relation> ?sub3 .

  ?sub3 <http://data.archiveshub.ac.uk/def/level> ?level3 .
  ?sub3 <http://purl.org/dc/terms/title> ?title3 .
  ?sub3 <http://purl.org/dc/terms/relation> ?sub4 .

  ?sub4 <http://data.archiveshub.ac.uk/def/level> ?level4 .
  ?sub4 <http://purl.org/dc/terms/title> ?title4 .
  ?sub4 <http://purl.org/dc/terms/relation> ?sub5 .

  ?sub5 <http://data.archiveshub.ac.uk/def/level> ?level5 .
  ?sub5 <http://purl.org/dc/terms/title> ?title5 .
  ?sub5 <http://purl.org/dc/terms/relation> ?sub6 .

  ?sub6 <http://data.archiveshub.ac.uk/def/level> ?level6 .
  ?sub6 <http://purl.org/dc/terms/title> ?title6 .
  ?sub6 <http://purl.org/dc/terms/relation> ?sub7 .

  ?sub7 <http://data.archiveshub.ac.uk/def/level> ?level7 .
  ?sub7 <http://purl.org/dc/terms/title> ?title7 .
  ?sub7 <http://purl.org/dc/terms/relation> ?sub8 .

  ?sub8 <http://data.archiveshub.ac.uk/def/level> ?level8 .
  ?sub8 <http://purl.org/dc/terms/title> ?title8 .
  ?sub8 <http://purl.org/dc/terms/relation> ?sub9 .

  ?sub9 <http://data.archiveshub.ac.uk/def/level> ?level9 .
  ?sub9 <http://purl.org/dc/terms/title> ?title9 .

  ?obj <http://schema.org/name> ?name .
  ?sub :score ?totalScore .
} WHERE {
  {
    SELECT ?sub ?totalScore WHERE {
      ${textmatch}
      ${filters}

      OPTIONAL {
        ?sub <http://www.w3.org/2006/time#intervalStarts> ?startOptional .
      }
      BIND ( COALESCE(STR(?startOptional), "0001-01-01") AS ?start )
      BIND ( xsd:date(CONCAT(SUBSTR(?start, 0, 10), SUBSTR("0001-01-01", STRLEN(?start) + 1))) AS ?startDate )
      BIND ( ?startDate - xsd:date(NOW()) AS ?startDelta )
      BIND ( COALESCE(xsd:float(STRBEFORE(STRAFTER(STR(?startDelta),"P"), "D")), 0) AS ?startScore )
      BIND ( COALESCE(?score, ?startScore) AS ?totalScore )
    }
    ORDER BY DESC(?totalScore)
    OFFSET ${offset}
    LIMIT ${limit}
  }

  ?sub ?pred ?obj .

  OPTIONAL {
    ?obj <http://schema.org/name> ?name .
  }

  OPTIONAL {
    ?sub <http://purl.org/dc/terms/relation> ?sub1 .
    ?sub1 <http://data.archiveshub.ac.uk/def/level> ?level1 .
    ?sub1 <http://purl.org/dc/terms/title> ?title1 .
    OPTIONAL {
      ?sub1 <http://purl.org/dc/terms/relation> ?sub2 .
      ?sub2 <http://data.archiveshub.ac.uk/def/level> ?level2 .
      ?sub2 <http://purl.org/dc/terms/title> ?title2 .
      OPTIONAL {
        ?sub2 <http://purl.org/dc/terms/relation> ?sub3 .
        ?sub3 <http://data.archiveshub.ac.uk/def/level> ?level3 .
        ?sub3 <http://purl.org/dc/terms/title> ?title3 .
        OPTIONAL {
          ?sub3 <http://purl.org/dc/terms/relation> ?sub4 .
          ?sub4 <http://data.archiveshub.ac.uk/def/level> ?level4 .
          ?sub4 <http://purl.org/dc/terms/title> ?title4 .
          OPTIONAL {
            ?sub4 <http://purl.org/dc/terms/relation> ?sub5 .
            ?sub5 <http://data.archiveshub.ac.uk/def/level> ?level5 .
            ?sub5 <http://purl.org/dc/terms/title> ?title5 .
            OPTIONAL {
              ?sub5 <http://purl.org/dc/terms/relation> ?sub6 .
              ?sub6 <http://data.archiveshub.ac.uk/def/level> ?level6 .
              ?sub6 <http://purl.org/dc/terms/title> ?title6 .
              OPTIONAL {
                ?sub6 <http://purl.org/dc/terms/relation> ?sub7 .
                ?sub7 <http://data.archiveshub.ac.uk/def/level> ?level7 .
                ?sub7 <http://purl.org/dc/terms/title> ?title7 .
                OPTIONAL {
                  ?sub7 <http://purl.org/dc/terms/relation> ?sub8 .
                  ?sub8 <http://data.archiveshub.ac.uk/def/level> ?level8 .
                  ?sub8 <http://purl.org/dc/terms/title> ?title8 .
                  OPTIONAL {
                    ?sub8 <http://purl.org/dc/terms/relation> ?sub9 .
                    ?sub9 <http://data.archiveshub.ac.uk/def/level> ?level9 .
                    ?sub9 <http://purl.org/dc/terms/title> ?title9 .
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
</script>

<script src="zack.min.js"></script>
<script src="renderer.js"></script>
<script src="intro.js"></script>
<script src="search.js"></script>
</body>
</html>
